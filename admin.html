<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Danh sách vị trí người dùng</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
  </head>
  <body>
    <h1>📍 Vị trí người dùng đã gửi</h1>
    <ul id="list"></ul>

    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyDNVr03Qhb00YdjHvBQxsEQQDh96UHtx1g",
        authDomain: "ncc1504-72c4c.firebaseapp.com",
        databaseURL:
          "https://ncc1504-72c4c-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "ncc1504-72c4c",
        storageBucket: "ncc1504-72c4c.firebasestorage.app",
        messagingSenderId: "522236411325",
        appId: "1:522236411325:web:280cd17913d1d294a926d4",
        measurementId: "G-5RG260HYPK",
      };

      firebase.initializeApp(firebaseConfig);
      const db = firebase.database();
      const list = document.getElementById("list");

      db.ref("locations").on("value", (snapshot) => {
        const data = snapshot.val();
        list.innerHTML = "";

        if (!data) {
          list.innerHTML = "<li>Chưa có ai gửi vị trí nào cả 😭</li>";
          return;
        }

        for (let key in data) {
          const item = data[key];
          const link = `https://www.google.com/maps?q=${item.lat},${item.lon}`;
          const li = document.createElement("li");
          li.innerHTML = `🧍 Vị trí: <a href="${link}" target="_blank">${
            item.lat
          }, ${item.lon}</a> - 🕒 Lúc: ${new Date(item.time).toLocaleString()}`;
          list.appendChild(li);
        }
      });
    </script>
  </body>
</html>
